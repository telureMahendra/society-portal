<div class="page-header">
    <div>
        <h1>Society Management</h1>
        <p>Monitor and manage all societies onboarded to the platform.</p>
    </div>
    <button class="btn btn-primary">
        <i class="icon-plus"></i> Onboard Society
    </button>
</div>

<div class="card p-0 overflow-hidden">
    <div class="table-actions p-4 border-bottom">
        <div class="search-group">
            <input type="text" [(ngModel)]="searchTerm" (input)="applyFilters()" placeholder="Search societies..."
                class="form-control">
        </div>

        <div class="filter-group-container">
            <select [(ngModel)]="federationFilter" (change)="onFilterChange()" class="form-select">
                <option value="ALL">All Federations</option>
                <option *ngFor="let fed of federations" [value]="fed">{{ fed }}</option>
            </select>

            <select [(ngModel)]="cityFilter" (change)="onFilterChange()" class="form-select">
                <option value="ALL">All Cities</option>
                <option *ngFor="let city of cities" [value]="city">{{ city }}</option>
            </select>

            <select [(ngModel)]="statusFilter" (change)="onFilterChange()" class="form-select">
                <option value="ALL">All Status</option>
                <option value="ACTIVE">Active</option>
                <option value="INACTIVE">Inactive</option>
            </select>
        </div>
    </div>

    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Society Name</th>
                    <th>Federation</th>
                    <th>Subdomain</th>
                    <th>City</th>
                    <th>Flats</th>
                    <th>Status</th>
                    <th class="text-end">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let soc of filteredSocieties">
                    <td>
                        <div class="fw-bold">{{ soc.name }}</div>
                    </td>
                    <td>{{ soc.federationName }}</td>
                    <td><code>{{ soc.subdomain }}</code></td>
                    <td>{{ soc.city }}</td>
                    <td>{{ soc.totalFlats }}</td>
                    <td>
                        <span class="badge" [ngClass]="soc.status === 'ACTIVE' ? 'badge-success' : 'badge-danger'">
                            {{ soc.status }}
                        </span>
                    </td>
                    <td class="text-end">
                        <button class="btn btn-icon" title="View Details">
                            <i class="icon-eye"></i>
                        </button>
                        <button class="btn btn-icon" (click)="toggleStatus(soc)"
                            [title]="soc.status === 'ACTIVE' ? 'Deactivate' : 'Activate'">
                            <i [class]="soc.status === 'ACTIVE' ? 'icon-toggle-on' : 'icon-toggle-off'"></i>
                        </button>
                    </td>
                </tr>
                <tr *ngIf="filteredSocieties.length === 0 && !isLoading">
                    <td colspan="7" class="text-center p-5 text-muted">
                        No societies found.
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>